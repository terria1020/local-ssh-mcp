{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "SSH Credentials",
  "description": "SSH credentials configuration for local-ssh-mcp",
  "type": "object",
  "required": ["version", "credentials"],
  "properties": {
    "version": {
      "type": "string",
      "enum": ["1.0"],
      "description": "Schema version"
    },
    "description": {
      "type": "string",
      "description": "Optional description"
    },
    "credentials": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/credential"
      }
    }
  },
  "definitions": {
    "credential": {
      "type": "object",
      "required": ["id", "name", "host", "username", "authType"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-z0-9-]+$",
          "description": "Unique identifier (lowercase, numbers, hyphens)"
        },
        "name": {
          "type": "string",
          "description": "Human-readable name"
        },
        "host": {
          "type": "string",
          "description": "SSH host address"
        },
        "port": {
          "type": "integer",
          "minimum": 1,
          "maximum": 65535,
          "default": 22,
          "description": "SSH port"
        },
        "username": {
          "type": "string",
          "description": "SSH username"
        },
        "authType": {
          "type": "string",
          "enum": ["key", "password"],
          "description": "Authentication type"
        },
        "privateKeyPath": {
          "type": "string",
          "description": "Path to private key file (required for key auth)"
        },
        "passphrase": {
          "type": "string",
          "description": "Base64 encoded passphrase for private key"
        },
        "password": {
          "type": "string",
          "description": "Base64 encoded password (required for password auth)"
        }
      },
      "allOf": [
        {
          "if": {
            "properties": { "authType": { "const": "key" } }
          },
          "then": {
            "required": ["privateKeyPath"]
          }
        },
        {
          "if": {
            "properties": { "authType": { "const": "password" } }
          },
          "then": {
            "required": ["password"]
          }
        }
      ]
    }
  }
}
